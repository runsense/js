<html>
  <head>
  <title>gestion</title>
	<script src="http://code.jquery.com/jquery-3.1.1.min.js"  ></script>
    <script type="text/javascript">
	$.urlParam=function(name){var results=new RegExp('[\?&]'+name+'=([^&#]*)').exec(window.location.href);try{return results[1]||0;}catch(e){return null;}};
	var FcT=FcT||{};var FcT={
		CLIENT_ID:'509253366175-jge7lbsp8q2qsjej2mfk3u315t1mprta.apps.googleusercontent.com',
		SCOPES:['https://www.googleapis.com/auth/drive'],
		checkAuth:function(){gapi.auth.authorize({'client_id':FcT.CLIENT_ID,'scope':FcT.SCOPES.join(' '),'immediate':false},FcT.handleAuthResult);},
		handleAuthResult:function(authResult){var authorizeDiv=document.getElementById('authorize-div');if(authResult && !authResult.error){
			var prmt=[$.urlParam('env'),$.urlParam('vid')];authorizeDiv.style.display='none';callScriptFunction(prmt);}else{authorizeDiv.style.display='inline';}},
		handleAuthClick:function(event){gapi.auth.authorize({client_id:CLIENT_ID,scope:FcT.SCOPES,immediate:false},FcT.handleAuthResult);return false;},
		callScriptFunction:function(prmt){var scriptId="1wpIl6YCi_miuJlHHTprpVC36bOEFOuYdPlre6DsJWC9q4n_0luSdZup1";var request={'function':'apiCalls','parameters':[prmt]};var op=gapi.client.request({'root':'https://script.googleapis.com','path':'v1/scripts/'+scriptId+':run','method':'POST','body':request});op.execute(function(resp){if(resp.error&&resp.error.status){FcT.appendPre('Error calling API:');FcT.appendPre(JSON.stringify(resp, null, 2));}else if(resp.error){var error=resp.error.details[0];FcT.appendPre('Script error message:'+error.errorMessage);if(error.scriptStackTraceElements){FcT.appendPre('Script error stacktrace:');for(var i=0;i<error.scriptStackTraceElements.length;i++){var trace=error.scriptStackTraceElements[i];FcT.appendPre('\t'+trace.function+':'+trace.lineNumber);}}}else{var rslt=resp.response.result;FcT.appendPre('error is send \n'+rslt);}});},
		appendPre:function(message){var pre=document.getElementById('output');var textContent=document.createTextNode(message+'\n');pre.appendChild(textContent);}
	};
	/*$.urlParam=function(name){var results=new RegExp('[\?&]'+name+'=([^&#]*)').exec(window.location.href);try{return results[1]||0;}catch(e){return null;}};
	if($('#map_canvas').css('width')==='800px'){bnm=false;}
      var CLIENT_ID = '509253366175-jge7lbsp8q2qsjej2mfk3u315t1mprta.apps.googleusercontent.com';

      var SCOPES = ['https://www.googleapis.com/auth/drive'];

      function checkAuth(){gapi.auth.authorize({'client_id': CLIENT_ID,'scope': SCOPES.join(' '),'immediate': false}, handleAuthResult);      }

      function handleAuthResult(authResult){var authorizeDiv=document.getElementById('authorize-div');if(authResult && !authResult.error){
	  var prmt=[$.urlParam('env'),$.urlParam('vid')];authorizeDiv.style.display='none';callScriptFunction(prmt);}else{authorizeDiv.style.display='inline';}}

       function handleAuthClick(event){gapi.auth.authorize({client_id:CLIENT_ID,scope:SCOPES,immediate:false},handleAuthResult);return false;}

       function callScriptFunction(prmt){
        var scriptId="1wpIl6YCi_miuJlHHTprpVC36bOEFOuYdPlre6DsJWC9q4n_0luSdZup1";
        var request={
            'function': 'apiCalls',
			'parameters': [prmt]
            };

        var op = gapi.client.request({
            'root': 'https://script.googleapis.com',
            'path': 'v1/scripts/' + scriptId + ':run',
            'method': 'POST',
            'body': request
        });

        op.execute(function(resp) {
          if (resp.error && resp.error.status) {
            appendPre('Error calling API:');
            appendPre(JSON.stringify(resp, null, 2));
          } else if (resp.error) {
            var error = resp.error.details[0];
            appendPre('Script error message: ' + error.errorMessage);

            if (error.scriptStackTraceElements) {
              appendPre('Script error stacktrace:');
              for (var i = 0; i < error.scriptStackTraceElements.length; i++) {
                var trace = error.scriptStackTraceElements[i];
                appendPre('\t' + trace.function + ':' + trace.lineNumber);
              }
            }
          } else {
            var rslt = resp.response.result;           
              appendPre('error is send \n'+rslt);            
          }
        });
      }
      function appendPre(message){var pre=document.getElementById('output');var textContent=document.createTextNode(message+'\n');pre.appendChild(textContent);}*/

    </script>
    <script src="https://apis.google.com/js/client.js?onload=FcT.checkAuth">
    </script>
  </head>
  <body>
    <div id="authorize-div" style="display: none">
      <span>Authorize access to Google Apps Script Execution API</span>
      <!--Button for the user to click to initiate auth sequence -->
      <button id="authorize-button" onclick="FcT.handleAuthClick(event)">
        Authorize
      </button>
    </div>
    <pre id="output"></pre>
  </body>
</html>