<!DOCTYPE html>
<<<<<<< HEAD
=======
<<<<<<< HEAD
>>>>>>> cbbaa496f8fe260e77fe8c716b6d320c76d7ee66
<html lang="fr">
<head>
    <title id='Description'>fram runsense</title>
	<link rel="stylesheet" href="./jqx/jqx.summer.css" type="text/css" />
    <link rel="stylesheet" href="./jqx/jqx.base.css" type="text/css" />
	 <style>
<<<<<<< HEAD
=======
=======
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>runsenseV3</title>
         <meta name="viewport" content="initial-scale=1.0, user-scalable=no"/>
    <meta charset="utf-8"/>
    <style>
>>>>>>> origin/gh-pages
>>>>>>> cbbaa496f8fe260e77fe8c716b6d320c76d7ee66
      html, body {
        height: 100%;
        margin: 0px;
        padding: 0px
      }
<<<<<<< HEAD
      #map_canvas,#listview  {
=======
      #map-canvas  {
>>>>>>> cbbaa496f8fe260e77fe8c716b6d320c76d7ee66
        position: absolute;
        height: 100%;
        width: 70%;
        margin: 0px;
        padding: 0px
      }
      #panel {
        position: absolute;
        top: 5px;
        right: 1%;
        width: 29%;
<<<<<<< HEAD
        height: 100%;
=======
        
>>>>>>> cbbaa496f8fe260e77fe8c716b6d320c76d7ee66
        z-index: 5;
        background-color: #fff;
        
        border: 1px solid #999;
      }
    </style>
<<<<<<< HEAD
=======
<<<<<<< HEAD
>>>>>>> cbbaa496f8fe260e77fe8c716b6d320c76d7ee66
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="./jqx/jqxcore.js"></script>
    <script type="text/javascript" src="./jqx/jqxbuttons.js"></script>
    <script type="text/javascript" src="./jqx/jqxscrollbar.js"></script>
    <script type="text/javascript" src="./jqx/jqxpanel.js"></script>
    <script type="text/javascript" src="./jqx/jqxtree.js"></script>
	<script type="text/javascript" src="./jqx/jqxcheckbox.js"></script>
	<script src="https://maps.googleapis.com/maps/api/js?sensor=false&libraries=places">
    </script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/jquery.address.js"></script>
    <script type="text/javascript" src="js/jquery.geocomplete.min.js"></script>
    <script type="text/javascript" src="js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="js/jquery.dataTables.sorting.js"></script>
    <script type="text/javascript" src="js/jquery.dataTables.bootstrap-pagination.js"></script>
   
</head>
<body class='default'> 
	<div id="map_canvas"></div>
<<<<<<< HEAD
	
        <div id="panel">
		<div id='jqxTree'>
		</div>
	
		
		
=======
	<div id='listview' style="display:none;"></div>
          <!--MODIFY link to publicly display your Google Fusion Tables data table, source, and text-->
          <p>View <a href='javascript:MapsLib.fusionTableId;' ></a>
      </div>
        <div id="panel">
		<div id='jqxTree'>
		</div>
		<table>
			<tr>
				<td>recherche :</td><td><input id="search_address" type="text" /></td>
			</tr>
			<tr>
				<td rows=2>
					<p><a class='btn btn-default' id='viewmode' href='#'>
						<i class='glyphicon glyphicon-list-alt'></i>
						Liste des données
					  </a></p>
				 </td>
			 </tr>
			<tr>
				<td>Itinéraire</td>
			</tr>
			<tr>
				<td>départ :</td><td><input id="dep" type="text" /></td>
			</tr>
			<tr>
				<td> arrivé :</td><td><input id="arv" type="text" /></td>
			</tr>
		</table>
		<div class='alert alert-info' id='result_box' ><strong id='result_count'></strong></div>
        </div>
>>>>>>> cbbaa496f8fe260e77fe8c716b6d320c76d7ee66
	 <script type="text/javascript" src="js/maps_lib.js"></script>	
    <script type='text/javascript'>
      //<![CDATA[
        $(window).resize(function () {
          var h = $(window).height(),
            offsetTop = 105; // Calculate the top offset
        
          $('#map_canvas').css('height', (h - offsetTop));
        }).resize();
        
        $(function() {
		
          MapsLib.initialize();
          $("#search_address").geocomplete();

          $('#viewmode').click(function(){
            if ($('#map_canvas').is(":visible")){
              $('#viewmode').html("<i class='glyphicon glyphicon-map-marker'></i> Map view");
              $('#listview').show();
              $('#map_canvas').hide();
            }

            else {
              $('#viewmode').html("<i class='glyphicon glyphicon-list-alt'></i> List view");
              $('#map_canvas').show();
                $('#listview').hide();
            } 
           });

          
          $(":text").keydown(function(e){
              var key =  e.keyCode ? e.keyCode : e.which;
              if(key == 13) {
                  $('#search').click();
                  return false;
              }
          });
        });
      //]]>
    </script>
</body>
<<<<<<< HEAD
</html>
=======
</html>
=======
    
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBT0oZNxCp8JSSQwaG0gq1U-MLIMF30bL4">
    
    </script>
    <script type="text/javascript">
            var directionsDisplay;
            var directionsService = new google.maps.DirectionsService();
            var map;
            var chad;
            var url='http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=0CB4QFjAA&url=http%3A%2F%2Fworldmap.org%2Fmaps%2Fprepared%2Fchurchstatus%2Freunion%2FReunion%2520-%2520Bible%2520Translation%2520-%2520WorldMAP.kml&ei=AnuVVey3CMu4UfH-vYgC&usg=AFQjCNFJJgqFoRfnSCoWpgEUphKo19VCsw&sig2=RrGeXROAeA8irWG3jvYCHw&bvm=bv.96952980,d.d24';
            //http://sites.google.com/site/kmlrunsense/reunion/%C3%AEledelaReunion.kml?attredirects=0&d=1;
            var dep;
            var ar;


             appelJSon=function()
                {
                    var geojson=JSON.parse(document.getElementById('panel:json').value);

                    map.data.addGeoJson(geojson);
                };
                additi = function(butiti)
                {
                    chad = butiti;
                };



            function zoom(map) {
              var bounds = new google.maps.LatLngBounds();
              map.data.forEach(function(feature) {
                processPoints(feature.getGeometry(), bounds.extend, bounds);
              });
              map.fitBounds(bounds);
            }

            function processPoints(geometry, callback, thisArg) {
              if (geometry instanceof google.maps.LatLng) {
                callback.call(thisArg, geometry);
              } else if (geometry instanceof google.maps.Data.Point) {
                callback.call(thisArg, geometry.get());
              } else {
                geometry.getArray().forEach(function(g) {
                  processPoints(g, callback, thisArg);
                });
              }
            }





            getAddressFromLatLong = function (latlng)
            {

                var lat=latlng.lat();
                var lng=latlng.lng();
               var xhr_object = null;

                            if(window.XMLHttpRequest) // Firefox
                               xhr_object = new XMLHttpRequest();
                            else if(window.ActiveXObject) // Internet Explorer
                               xhr_object = new ActiveXObject("Microsoft.XMLHTTP");
                            else { // XMLHttpRequest non supportÃ© par le navigateur
                               alert("Votre navigateur ne supporte pas les objets XMLHTTPRequest !!");

                            }


                            xhr_object.open('GET', 'http://maps.googleapis.com/maps/api/geocode/xml?latlng='+lat+','+lng+'&sensor=false', false);
                            xhr_object.send(null);
                            if(xhr_object.readyState === 4)
                            {

                                 repiti = xhr_object.responseText;
                                 //alert(repiti);
                                 var tsplit = repiti.split('<formatted_address>');
                                 if(tsplit!==null)
                                     {
                                         var tsplit = tsplit[1].split('</formatted_address>');
                                         var ad=tsplit[0];
                                         //alert(ad);
                                         document.getElementById('panel:'+chad).value =ad;

                                     }





                            }



                };

                clickmap=function(pos)
                {
                    alert(' ');
                    takeInf(map);
                    getAddressFromLatLong(pos.latLng);
                    calcRoute();

                    map.setMapTypeId(google.maps.MapTypeId.HYBRID)

                };
                takeInf=function(map)
                { 
                     map.data.forEach(function(feature) {

                        layer.setOptions({
                            query: {
                              select: 'geometry',
                              from: '1jKAPLk2NOAcc2NdZ1sixkH-Sim7LAQwLAvGJgKLt',
                              where:'geometry='+feature
                            },
                            styles: [{
                              polygonOptions: {
                                fillColor: '#00FF00',
                                fillOpacity: 1
                              }
                            }]
                          });

                          //layer.setMap(map);
                      });
                };
            function initialize() {
              directionsDisplay = new google.maps.DirectionsRenderer();
              var mapOptions ={
                zoom:10,
                center: { lat: -21.137472, lng: 55.546906}
              };
              map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
              google.maps.event.addListener(map, "click", function(event) {
                        clickmap(event);
                         });
              directionsDisplay.setMap(map);

              layer = new google.maps.FusionTablesLayer({
                query: {
                  select: 'geometry',
                  from: '1jKAPLk2NOAcc2NdZ1sixkH-Sim7LAQwLAvGJgKLt'
                },
                styles: [{
                  polygonOptions: {
                    fillColor: '#00FF00',
                    fillOpacity: 0.1
                  }
                }]
              });

              layer.setMap(map);


            };

            function calcRoute() {

              var start = document.getElementById('dep').value;
                var end = document.getElementById('arv').value;

              var request = {
                  origin:start,
                  destination:end,
                  travelMode: google.maps.TravelMode.DRIVING
              };
              directionsService.route(request, function(response, status) {

                if (status == google.maps.DirectionsStatus.OK) {
                  directionsDisplay.setDirections(response);
                   zoom(map);
                }
              });
              directionsDisplay.setPanel(document.getElementById('panel'));
            }

            google.maps.event.addDomListener(window, 'load', initialize);

        </script>
   
    </head>
    <body>
        <div id="map-canvas"></div>
        <div id="panel">
            <input id="dep" type="text" />
            <input id="arv" type="text" />
        </div>
        
    </body>
</html>
>>>>>>> origin/gh-pages
>>>>>>> cbbaa496f8fe260e77fe8c716b6d320c76d7ee66
